"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["instant-page.plugin"],{439:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class i extends window.PluginBaseClass{init(){this.options._preloadedList=new Set;let e=this;if(!document.createElement("link").relList.supports("prefetch"))return;let t="instantVaryAccept"in document.body.dataset||"Shopify"in window,n=navigator.userAgent.indexOf("Chrome/");if(n>-1&&(this.options._chromiumMajorVersionInUserAgent=parseInt(navigator.userAgent.substring(n+7))),t&&this.options._chromiumMajorVersionInUserAgent&&this.options._chromiumMajorVersionInUserAgent<110)return;let i="instantMousedownShortcut"in document.body.dataset;this.options._allowQueryString="instantAllowQueryString"in document.body.dataset,this.options._allowExternalLinks="instantAllowExternalLinks"in document.body.dataset,this.options._useWhitelist="instantWhitelist"in document.body.dataset;let o={capture:!0,passive:!0},s=!1,r=!1,a=!1;if("instantIntensity"in document.body.dataset){let e=document.body.dataset.instantIntensity;if(e.startsWith("mousedown"))s=!0,"mousedown-only"==e&&(r=!0);else if(e.startsWith("viewport")){let t=navigator.connection&&navigator.connection.saveData,n=navigator.connection&&navigator.connection.effectiveType&&navigator.connection.effectiveType.includes("2g");t||n||("viewport"==e?document.documentElement.clientWidth*document.documentElement.clientHeight<45e4&&(a=!0):"viewport-all"!=e||(a=!0))}else{let t=parseInt(e);isNaN(t)||(this.options._delayOnHover=t)}}if(r||document.addEventListener("touchstart",this.touchstartListener.bind(this),o),s?i||document.addEventListener("mousedown",this.mousedownListener.bind(this),o):document.addEventListener("mouseover",this.mouseoverListener.bind(this),o),i&&document.addEventListener("mousedown",this.mousedownShortcutListener.bind(this),o),a){let t=window.requestIdleCallback;t||(t=e=>{e()}),t(function(){let t=new IntersectionObserver(n=>{n.forEach(n=>{if(n.isIntersecting){let i=n.target;t.unobserve(i),e.preload(i.href)}})});document.querySelectorAll("a").forEach(n=>{e.isPreloadable(n)&&t.observe(n)})},{timeout:1500})}}touchstartListener(e){this.options._lastTouchTimestamp=performance.now();let t=e.target.closest("a");this.isPreloadable(t)&&this.preload(t.href,"high")}mouseoverListener(e){let t=this;if(performance.now()-this.options._lastTouchTimestamp<this.options.DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION||!("closest"in e.target))return;let n=e.target.closest("a");this.isPreloadable(n)&&(n.addEventListener("mouseout",this.mouseoutListener.bind(this),{passive:!0}),this.options._mouseoverTimer=setTimeout(()=>{t.preload(n.href,"high"),t.options._mouseoverTimer=void 0},t.options._delayOnHover))}mousedownListener(e){let t=e.target.closest("a");this.isPreloadable(t)&&this.preload(t.href,"high")}mouseoutListener(e){(!e.relatedTarget||e.target.closest("a")!=e.relatedTarget.closest("a"))&&this._mouseoverTimer&&(clearTimeout(this.options._mouseoverTimer),this.options._mouseoverTimer=void 0)}mousedownShortcutListener(e){if(performance.now()-this.options._lastTouchTimestamp<this.options.DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION)return;let t=e.target.closest("a");if(e.which>1||e.metaKey||e.ctrlKey||!t)return;t.addEventListener("click",function(e){1337!=e.detail&&e.preventDefault()},{capture:!0,passive:!1,once:!0});let n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1,detail:1337});t.dispatchEvent(n)}isPreloadable(e){if(!(!e||!e.href||e.href.includes("/account")||e.href.includes("/checkout")||e.href.includes("/payment")||e.href.includes("/wishlist")||e.href.includes("line-item"))&&(!this.options._useWhitelist||"instant"in e.dataset)&&(e.origin==location.origin||(this.options._allowExternalLinks||"instant"in e.dataset)&&this.options._chromiumMajorVersionInUserAgent)&&["http:","https:"].includes(e.protocol)&&("http:"!=e.protocol||"https:"!=location.protocol)&&(this.options._allowQueryString||!e.search||"instant"in e.dataset)&&(!e.hash||e.pathname+e.search!=location.pathname+location.search)&&!("noInstant"in e.dataset))return!0}preload(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";if(this.options._preloadedList.has(e))return;let n=document.createElement("link");n.rel="prefetch",n.href=e,n.fetchPriority=t,n.as="document",document.head.appendChild(n),this.options._preloadedList.add(e)}}i.options={_chromiumMajorVersionInUserAgent:null,_allowQueryString:null,_allowExternalLinks:null,_useWhitelist:null,_delayOnHover:65,_lastTouchTimestamp:null,_mouseoverTimer:null,_preloadedList:null,DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION:1111}}}]);